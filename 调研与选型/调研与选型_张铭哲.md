## 开发工具选型

毋庸置疑需要微信开发者工具。其实也有一些可视化小程序开发工具（微盟、微尘），但这些工具一般是提供固定的组件和成熟的模板，通过拖拽等操作完成搭建，对于复杂的需求与设计就显得无力。而官方开发工具自由度高，可以任意开发想要的功能。

## 小程序开发框架

主要的五种微信小程序开发框架：

- 原生框架
- WePY
- mpvue
- Taro
- uni-app

### 原生框架

整个小程序框架系统分为两部分：逻辑层和视图层。小程序提供了自己的视图层描述语言 `WXML` 和 `WXSS`，以及基于 `JavaScript` 的逻辑层框架，并在视图层与逻辑层间提供了数据传输和事件系统

原生开发对Node、预编译器、webpack支持不好，影响开发效率和工程构建流程。微信小程序本身对工程化几乎没有任何的支持，要原生框架支持工程化的话，需要自己动手搭建很多工程化上的东西。

没有提供原生的应用状态管理方式，但是支持使用 Redux 或 MobX 进行状态管理。

### WePY

需要熟悉 vue 和 WePY 两种语法。

WePY 框架在开发过程中参考了 Vue 等现有框架的一些语法风格和功能特性，对原生小程序的开发模式进行了再次封装，更贴近于MVVM架构模式。

WePY 有如下特性：

- 支持组件化开发。原生小程序支持js[模块化](https://mp.weixin.qq.com/debug/wxadoc/dev/framework/app-service/module.html?t=20161107)，但彼此独立，业务代码与交互事件仍需在页面处理。无法实现组件化的松耦合与复用的效果。

- 支持使用 npm 外部依赖。

- 目录结构清晰。在 WePY 中则使用了单文件模式，将原生小程序app实例的3个文件统一为`app.wpy`，page页面的4个文件统一为`page.wpy`。

  ```
  project
  └── src
      ├── pages
      |   ├── index.wpy    index 页面逻辑、配置、结构、样式
      |   └── log.wpy      log 页面逻辑、配置、结构、样式
      └──app.wpy           小程序逻辑、公共配置、公共样式
  ```

- 便于工程化。wepy 有自己的 wepy-cli。

- 支持使用 Redux 或 MobX 进行状态管理。



### mpvue

需要熟悉 vue。

`mpvue`是一个使用 [Vue.js](https://vuejs.org/) 开发小程序的前端框架。框架基于 `Vue.js`，修改了的运行时框架 runtime 和代码编译器 compiler 实现，使其可运行在小程序环境中，从而为小程序开发引入了 `Vue.js` 开发体验，在用法上面是高度和 Vue 一致的。

mpvue 有如下特性：

- 彻底的组件化开发能力：提高代码复用性。
- 支持使用 npm 外部依赖。
- 快捷的 `webpack` 构建机制：自定义构建策略、开发阶段 hotReload。
- 方便的 `Vuex` 数据管理方案：方便构建复杂应用与应用状态管理。



### Taro

需要熟悉React语法标准。

Taro 是一套遵循 [React](https://reactjs.org/) 语法规范的**多端开发**解决方案。

Taro 有如下特性：

- 二次开发。可以将原生微信小程序应用转换为 Taro 代码，进而通过 `taro build` 的命令将 Taro 代码转换为对应平台的代码，或者对转换后的 Taro 代码用 React 的方式进行二次开发。
- 支持使用 JSX 语法。让代码更具表现性。
- 支持使用 npm/yarn 安装管理第三方依赖。
- 支持使用 ES7/ES8 甚至更新的 ES 规范。
- 支持使用 CSS 预编译器。
- 支持使用 Redux 或 MobX 进行状态管理。
- 小程序 API 优化，异步 API Promise 化。



### uni-app

需要熟悉 vue。

`uni-app` 是一个使用 [Vue.js](https://vuejs.org/) 开发所有前端应用的多端框架。可发布到iOS、Android、H5、以及各种小程序（微信/支付宝/百度/头条/QQ/钉钉）等多个平台。

 有如下特性：

- 支持使用 npm 外部依赖。
- 支持微信小程序自定义组件及SDK。
- 将常用组件和API进行跨平台封装。
- 内嵌mpvue，提供uni扩展组件及mpvue兼容组件。
- 支持条件编译，可在条件编译代码块中，随意调用各个平台新增的API及组件.



### 五种框架对比

其中部分指标引用了[小程序开发：用原生还是选框架](https://ask.dcloud.net.cn/article/35947)中的测试结果。

|   指标   |            原生框架            |                     WePY                      |              mpvue              |                   Taro                   |                uni-app                |
| :------: | :----------------------------: | :-------------------------------------------: | :-----------------------------: | :--------------------------------------: | :-----------------------------------: |
| 语法规范 |         小程序开发规范         |                 类Vue开发规范                 |          VueJS开发规范          |              React开发规范               |             VueJS开发规范             |
| 多端复用 |             不支持             |                    支持H5                     |             支持H5              | 支持H5、React-Native、各种小程序、快应用 | 支持iOS、Android、H5、以及各种小程序  |
| 数据管理 |         Redux 或 MobX          |                 Redux 或 MobX                 |              Vuex               |              Redux 或 MobX               |                 Vuex                  |
| 社区生态 | 自建社区，官方不公开发展交流群 |               无论坛，无法入群                |            9个微信群            |                9个微信群                 |      自建社区，40多个QQ、微信群       |
| 上手成本 |       文档丰富，但要新学       | 文档较少，要熟悉VueJS，但也要单独学习它的规则 | 文档较少，但不复杂，要熟悉VueJS |         文档较丰富，要熟悉React          | 文档丰富，要熟悉VueJS，但听说坑比较多 |
| 综合性能 |               3                |                       2                       |                1                |                    3                     |                   4                   |



## 小游戏开发框架

- Cocos
- Gegjs
- Egret
- Laya

关于微信小游戏的基础技术限制：

- 不允许操作 DOM、BOM、如果必须改成小游戏相应的 API 调用方式，目前引擎会自动引入weapp-adapter.js 文件做兼容处理。
- 不允许动态执行代码的能力，eval、setTimeout 和 setInterval 函数的第一个参数不能为字符串，Function构造函数的参数不能为字符串。

- 关于小游戏体积问题，小游戏的体积不得大于 4M，缓存不得大于 50M。具体的解释为：
  1. 本地的代码和资源不得超过 4M。
  2. 单个小游戏项目缓存的文件不能超过 50M，目前当缓存超过 50M 时后续的资源将不会缓存，未来新版的 AssetsManager 将会允许开发者自定义哪些资源需要缓存的机制。
  3. 不允许从服务器下载脚本文件。

小游戏的运行环境在 iOS 上是 JavaScriptCore，在 Android 上是 V8，都是没有 BOM 和 DOM 的运行环境，没有全局的 document 和 window 对象。因此当你希望使用 DOM API 来创建 Canvas 和 Image 等元素的时候，会引发错误。

也就是说如果直接使用主流的 HTML5 游戏引擎如 Egret、Cocos、Laya 开发的游戏是无法直接运行在小游戏上的。

小游戏为主流 HTML5 游戏引擎的适配提供了 Adapter，Adapter 可以使用 wx API 模拟 BOM 和 DOM。顾名思义，这是对基于浏览器环境的游戏引擎在小游戏运行环境下的一层适配层，使游戏引擎在调用 DOM API 和访问 DOM 属性时不会产生错误。

### Cocos

早在微信官方正式发布小游戏之前，Cocos Creator 团队就和微信开发团队合作完成了 Cocos Creator 对微信小游戏的支持。Cocos支持**C++、lua、js**等开发语言。

- 引擎框架适配微信小游戏 API，纯游戏逻辑层面，开发者不需要任何额外的修改

- Cocos Creator 编辑器提供了快捷的打包流程，直接发布为微信小游戏，并自动唤起小游戏的开发者工具
- 自动加载远程资源，缓存资源以及缓存资源版本控制

### Gegjs

[Gengine](https://github.com/GengineJS/geg.git) 是一个基于 **Vue.js** 核心开发的前端框架，与Vue采用Typescript不同，Geg采用的是Es6开发,并修改了 Vue.js 的底层实现，包括了compile与platforms，并新增gxml部分。框架通过xml组织视图层级，所以它与底层视图渲染的方式,如dom的渲染等并没有直接关系，也因为这个特点，虽然Gengine开发之初是为了使用Vue兼容微信小游戏而设计，但是理论上可以使用Geg.js开发任意特定平台的视图项目。

### Egret

Egret Engine是一个基于**TypeScript**语言开发的HTML5游戏引擎

- 目前只支持白鹭引擎 5.1.x 版本发布为微信小游戏，推荐使用最新的 5.1.2 版本。
- 支持第三方扩展库。

### Laya

Layabox支持**JavaScript、TypeScript、ActionScript**三种开发语言。支持开发2D、3D、VR的产品研发，支持Canvas与WebGL模式，支持同时发布为HTML5、Flash、APP（IOS、安卓）微信小游戏，QQ玩一玩多种版本。